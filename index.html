<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Cross-Origin-Opener-Policy" content="same-origin">
    <meta http-equiv="Cross-Origin-Embedder-Policy" content="require-corp">
    <meta http-equiv="Content-Security-Policy" content="script-src 'self' 'unsafe-eval' 'unsafe-inline' blob:; worker-src 'self' blob:;">
    <title>M3L</title>
    <link rel="stylesheet" href="/src/styles.css">
</head>

<body>
    <div class="container">
        <div class="main-content">
            <!-- Left Panel -->
            <div class="input-panel">
                <div class="input-section">
                    <!-- Help Icon -->
                    <div class="theme-help-section">
                        <h1 class="app-title">M3L</h1>
                        <div class="color-selector">
                            <button class="color-option purple" data-theme="purple" title="Purple Theme">
                                <span class="color-dot"></span>
                            </button>
                            <button class="color-option amber" data-theme="amber" title="Amber Theme">
                                <span class="color-dot"></span>
                            </button>
                            <button class="color-option white" data-theme="white" title="White Theme">
                                <span class="color-dot"></span>
                            </button>
                        </div>
                        <button class="settings-icon" aria-label="Settings">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M12 15.5C14.21 15.5 16 13.71 16 11.5C16 9.29 14.21 7.5 12 7.5C9.79 7.5 8 9.29 8 11.5C8 13.71 9.79 15.5 12 15.5ZM19.43 12.97C19.47 12.65 19.5 12.33 19.5 12C19.5 11.67 19.47 11.34 19.43 11L21.54 9.37C21.73 9.22 21.78 8.95 21.66 8.73L19.66 5.27C19.54 5.05 19.27 4.96 19.05 5.05L16.56 6.05C16.04 5.66 15.5 5.32 14.87 5.07L14.5 2.42C14.46 2.18 14.25 2 14 2H10C9.75 2 9.54 2.18 9.5 2.42L9.13 5.07C8.5 5.32 7.96 5.66 7.44 6.05L4.95 5.05C4.73 4.96 4.46 5.05 4.34 5.27L2.34 8.73C2.21 8.95 2.27 9.22 2.46 9.37L4.57 11C4.53 11.34 4.5 11.67 4.5 12C4.5 12.33 4.53 12.65 4.57 12.97L2.46 14.63C2.27 14.78 2.21 15.05 2.34 15.27L4.34 18.73C4.46 18.95 4.73 19.04 4.95 18.95L7.44 17.95C7.96 18.34 8.5 18.68 9.13 18.93L9.5 21.58C9.54 21.82 9.75 22 10 22H14C14.25 22 14.46 21.82 14.5 21.58L14.87 18.93C15.5 18.68 16.04 18.34 16.56 17.95L19.05 18.95C19.27 19.04 19.54 18.95 19.66 18.73L21.66 15.27C21.78 15.05 21.73 14.78 21.54 14.63L19.43 12.97Z" fill="currentColor"/>
                            </svg>
                        </button>
                        <button class="help-icon" aria-label="Show Help">?</button>
                    </div>

                    <div class="file-section">
                        <button id="upload-btn">Select File</button>
                        <input type="file" id="file-input" accept=".csv,.json">
                        <span class="file-name">No file selected</span>
                    </div>

                    <div class="query-section">
                        <textarea id="nl-query" placeholder="Ask a question about your data..."></textarea>
                        <div class="query-options">
                            <label class="shortcut-option">
                                <input type="checkbox" id="enable-shortcut" checked>
                                <span class="checkbox-text">Use âŒ˜/Enter to ask question</span>
                            </label>
                        </div>
                        <button id="submit-query">Ask Question</button>
                    </div>
                </div>
            </div>

            <!-- Right Panel -->
            <div class="results-panel">
                <div class="results-section">
                    <div class="results-actions">
                        <button id="export-pdf" class="export-button" title="Export as PDF">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M19 9h-4V3H9v6H5l7 7 7-7zM5 18v2h14v-2H5z" fill="currentColor"/>
                            </svg>
                            Export PDF
                        </button>
                    </div>
                    <div class="results-container">
                        <!-- Individual result blocks will be added here -->
                    </div>
                </div>
            </div>
        </div>

        <!-- Help Modal -->
        <div class="help-modal" hidden>
            <div class="help-content">
                <button class="close-help">Ã—</button>
                <h1>ðŸ‘‹ I'm M3L</h1>
                <p>Your personal AI data analyst. Here's how it works:</p>
                <ul class="feature-list">
                    <li>Load your data file securely</li>
                    <li>Connect with your AI service provider</li>
                    <li>Ask questions about your data</li>
                    <li>All analysis happens right on your computer</li>
                    <li>Only basic data structure is shared with your AI provider</li>
                </ul>
            </div>
        </div>

        <!-- Add Settings Modal -->
        <div class="settings-modal" hidden>
            <div class="settings-content">
                <button class="close-settings">Ã—</button>
                <h2>Settings</h2>
                <div class="settings-form">
                    <div class="form-group">
                        <label for="settings-api-key">API Key</label>
                        <input type="password" id="settings-api-key" placeholder="Enter OpenAI/Claude API Key">
                    </div>
                    <div class="form-group">
                        <label for="settings-api-provider">API Provider</label>
                        <select id="settings-api-provider">
                            <option value="openai">OpenAI</option>
                            <option value="claude">Claude</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="checkbox-label">
                            <input type="checkbox" id="persist-settings">
                            <span>Keep the key and service persisted</span>
                        </label>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Mobile floating action button -->
    <button class="mobile-query-fab" id="mobile-query-btn">
        Ask Query
    </button>
    <script type="module" src="/src/main.ts"></script>
</body>

</html>